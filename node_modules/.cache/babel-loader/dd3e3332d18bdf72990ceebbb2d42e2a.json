{"ast":null,"code":"import\"antd/es/card/style\";import _Card from\"antd/es/card\";import\"antd/es/col/style\";import _Col from\"antd/es/col\";import\"antd/es/avatar/style\";import _Avatar from\"antd/es/avatar\";import\"antd/es/row/style\";import _Row from\"antd/es/row\";import _toConsumableArray from\"F:\\\\Project\\\\walkspanDeploy\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"F:\\\\Project\\\\walkspanDeploy\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";//import { GMap } from \"./gmap\";\nimport CustomizeMap from\"./customizeMap\";import styles from\"./index.module.less\";import{useDispatch,useMappedState}from\"redux-react-hook\";import{getPlaceResult}from\"../../../../actions/map\";var mapStateWidget=function mapStateWidget(state){return state.widget;};var mapStateMap=function mapStateMap(state){return state.map;};var getMapFeature=function getMapFeature(featureName){if(featureName===\"nature\"){return\"beauty_n\";}if(featureName===\"architecture\"){return\"beauty_m\";}return featureName;};var getZoom=function getZoom(scope){switch(scope){case\"block\":return 20;case\"quarterMile\":return 19;default:case\"neighborhood\":return 18;}};function Map(params){var featuresStatus=JSON.parse(JSON.stringify(params.featuresStatus));//convert the address into lng/lat\nvar dispatch=useDispatch();var _useMappedState=useMappedState(mapStateWidget),_useMappedState$widge=_useMappedState.widgetResult,widgetResult=_useMappedState$widge===void 0?{address:\"574 Hudson St, New York, NY 10014, USA\"}:_useMappedState$widge;var _useMappedState2=useMappedState(mapStateMap),placeResult=_useMappedState2.placeResult;// const { address  } = widgetResult;\nvar _params$addressInput=params.addressInput,addressInput=_params$addressInput===void 0?\"\":_params$addressInput;var _useState=useState(),_useState2=_slicedToArray(_useState,2),address=_useState2[0],setAddress=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),features=_useState4[0],setFeatures=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),checkedFeature=_useState6[0],setCheckedFeature=_useState6[1];var _useState7=useState({lat:40.76778789999999,lng:-73.99174099999999}),_useState8=_slicedToArray(_useState7,2),center=_useState8[0],setCenter=_useState8[1];var selectIcon=function selectIcon(select){var new_features_info=_toConsumableArray(features);new_features_info.map(function(feature){if(feature.name===select.name){feature.isChecked=!feature.isChecked;setCheckedFeature(feature.name.toLowerCase());}else{feature.isChecked=false;}});setFeatures(new_features_info);};useEffect(function(){if(address===undefined)return;dispatch(getPlaceResult({query:address,key:\"AIzaSyBOXYeVd2IW4rON6FTyLBesJOG87NE3BJo\"}));},[dispatch,address]);useEffect(function(){var copyFeatures=featuresStatus.filter(function(item){return item.isChecked;});copyFeatures.map(function(item){return item.isChecked=false;});setFeatures(copyFeatures);if(addressInput!==\"\"){setAddress(addressInput);}else{setAddress(widgetResult.address);}},[]);useEffect(function(){if(placeResult!==undefined)setCenter(placeResult.geometry.location);},[placeResult]);return/*#__PURE__*/React.createElement(\"div\",{className:styles.map_container},/*#__PURE__*/React.createElement(CustomizeMap,{center:center,zoom:getZoom(params.scope),featureName:getMapFeature(checkedFeature),key:checkedFeature}),Array.isArray(features)&&features.length!==0&&/*#__PURE__*/React.createElement(_Card,{className:styles.panel},/*#__PURE__*/React.createElement(_Row,null,/*#__PURE__*/React.createElement(\"span\",null,\"Selected Feature\")),/*#__PURE__*/React.createElement(_Row,null,features&&features.map(function(item){return item&&/*#__PURE__*/React.createElement(_Col,{key:item.id,span:6},/*#__PURE__*/React.createElement(\"div\",{className:styles.featureUnit,onClick:function onClick(){return selectIcon(item);},description:item.description,id:item.id},/*#__PURE__*/React.createElement(\"div\",{className:styles.avatar},item.isChecked?/*#__PURE__*/ // <Avatar size={45} src={item.img_new} />\nReact.createElement(_Avatar,{size:45,src:require(\"../../../../img/widgets/\"+item.name.toLowerCase()+\"-new.png\")}):/*#__PURE__*/ //<Avatar size={45} src={item.img_faded} />\nReact.createElement(_Avatar,{size:45,src:require(\"../../../../img/widgets/\"+item.name.toLowerCase()+\"-faded.png\")}))));}))));}export default Map;","map":{"version":3,"sources":["F:/Project/walkspanDeploy/src/pages/widgets/WidgetBox/Map/Map.js"],"names":["React","useEffect","useState","CustomizeMap","styles","useDispatch","useMappedState","getPlaceResult","mapStateWidget","state","widget","mapStateMap","map","getMapFeature","featureName","getZoom","scope","Map","params","featuresStatus","JSON","parse","stringify","dispatch","widgetResult","address","placeResult","addressInput","setAddress","features","setFeatures","checkedFeature","setCheckedFeature","lat","lng","center","setCenter","selectIcon","select","new_features_info","feature","name","isChecked","toLowerCase","undefined","query","key","copyFeatures","filter","item","geometry","location","map_container","Array","isArray","length","panel","id","featureUnit","description","avatar","require"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\n//import { GMap } from \"./gmap\";\r\nimport CustomizeMap from \"./customizeMap\";\r\nimport styles from \"./index.module.less\";\r\nimport { Card, Col, Avatar, Row } from \"antd\";\r\nimport { useDispatch, useMappedState } from \"redux-react-hook\";\r\nimport { getPlaceResult } from \"../../../../actions/map\";\r\n\r\nconst mapStateWidget = (state) => state.widget;\r\nconst mapStateMap = (state) => state.map;\r\n\r\nconst getMapFeature = (featureName) => {\r\n  if (featureName === \"nature\") {\r\n    return \"beauty_n\";\r\n  }\r\n\r\n  if (featureName === \"architecture\") {\r\n    return \"beauty_m\";\r\n  }\r\n  return featureName;\r\n};\r\n\r\nconst getZoom = (scope) => {\r\n  switch (scope) {\r\n    case \"block\":\r\n      return 20;\r\n\r\n    case \"quarterMile\":\r\n      return 19;\r\n\r\n    default:\r\n    case \"neighborhood\":\r\n      return 18;\r\n  }\r\n};\r\n\r\nfunction Map(params) {\r\n  const featuresStatus = JSON.parse(JSON.stringify(params.featuresStatus));\r\n  //convert the address into lng/lat\r\n  const dispatch = useDispatch();\r\n  const {\r\n    widgetResult = { address: \"574 Hudson St, New York, NY 10014, USA\" },\r\n  } = useMappedState(mapStateWidget);\r\n  const { placeResult } = useMappedState(mapStateMap);\r\n  // const { address  } = widgetResult;\r\n  const { addressInput = \"\" } = params;\r\n  const [address, setAddress] = useState();\r\n  const [features, setFeatures] = useState([]);\r\n  const [checkedFeature, setCheckedFeature] = useState();\r\n  const [center, setCenter] = useState({\r\n    lat: 40.76778789999999,\r\n    lng: -73.99174099999999,\r\n  });\r\n  const selectIcon = (select) => {\r\n    let new_features_info = [...features];\r\n    new_features_info.map((feature) => {\r\n      if (feature.name === select.name) {\r\n        feature.isChecked = !feature.isChecked;\r\n        setCheckedFeature(feature.name.toLowerCase());\r\n      } else {\r\n        feature.isChecked = false;\r\n      }\r\n    });\r\n\r\n    setFeatures(new_features_info);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (address === undefined) return;\r\n    dispatch(\r\n      getPlaceResult({\r\n        query: address,\r\n        key: \"AIzaSyBOXYeVd2IW4rON6FTyLBesJOG87NE3BJo\",\r\n      })\r\n    );\r\n  }, [dispatch, address]);\r\n\r\n  useEffect(() => {\r\n    const copyFeatures = featuresStatus.filter((item) => item.isChecked);\r\n    copyFeatures.map((item) => (item.isChecked = false));\r\n    setFeatures(copyFeatures);\r\n\r\n    if (addressInput !== \"\") {\r\n      setAddress(addressInput);\r\n    } else {\r\n      setAddress(widgetResult.address);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (placeResult !== undefined) setCenter(placeResult.geometry.location);\r\n  }, [placeResult]);\r\n\r\n  return (\r\n    <div className={styles.map_container}>\r\n      <CustomizeMap\r\n        center={center}\r\n        zoom={getZoom(params.scope)}\r\n        featureName={getMapFeature(checkedFeature)}\r\n        key={checkedFeature}\r\n      />\r\n      {Array.isArray(features) && features.length !== 0 && (\r\n        <Card className={styles.panel}>\r\n          <Row>\r\n            <span>Selected Feature</span>\r\n          </Row>\r\n          <Row>\r\n            {features &&\r\n              features.map((item) => {\r\n                return (\r\n                  item && (\r\n                    <Col key={item.id} span={6}>\r\n                      <div\r\n                        className={styles.featureUnit}\r\n                        onClick={() => selectIcon(item)}\r\n                        description={item.description}\r\n                        id={item.id}\r\n                      >\r\n                        <div className={styles.avatar}>\r\n                          {item.isChecked ? (\r\n                            // <Avatar size={45} src={item.img_new} />\r\n                            <Avatar\r\n                              size={45}\r\n                              src={require(\"../../../../img/widgets/\" +\r\n                                item.name.toLowerCase() +\r\n                                \"-new.png\")}\r\n                            />\r\n                          ) : (\r\n                            //<Avatar size={45} src={item.img_faded} />\r\n                            <Avatar\r\n                              size={45}\r\n                              src={require(\"../../../../img/widgets/\" +\r\n                                item.name.toLowerCase() +\r\n                                \"-faded.png\")}\r\n                            />\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                    </Col>\r\n                  )\r\n                );\r\n              })}\r\n          </Row>\r\n        </Card>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Map;\r\n"]},"metadata":{},"sourceType":"module"}