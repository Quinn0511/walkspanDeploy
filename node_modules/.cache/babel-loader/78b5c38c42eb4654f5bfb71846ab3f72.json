{"ast":null,"code":"import \"antd/es/modal/style\";\nimport _Modal from \"antd/es/modal\";\nimport \"antd/es/card/style\";\nimport _Card from \"antd/es/card\";\nimport \"antd/es/button/style\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/notification/style\";\nimport _notification from \"antd/es/notification\";\nimport \"antd/es/input/style\";\nimport _Input from \"antd/es/input\";\nvar _jsxFileName = \"F:\\\\Project\\\\walkspanDeploy\\\\src\\\\pages\\\\widgets\\\\WidgetBox\\\\widgetBox.js\";\nimport React, { useEffect, useState } from \"react\";\nimport IndividualScore from \"./IndividualScore/IndividualScore\";\nimport ComparisonScore from \"./ComparisonScore/ComparisonScore\";\nimport Map from \"./Map/Map\";\nimport NoResult from \"./noResult\"; //import styles from \"./widgetBox.module.less\";\n\nimport { useDispatch, useMappedState } from \"redux-react-hook\";\nimport { addUserWidget } from \"../../../actions/widget\";\nconst {\n  TextArea\n} = _Input;\n\nconst mapStateWidget = state => state.widget;\n\nconst operationTabList = [{\n  key: \"individual_scores\",\n  tab: /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 16,\n      columnNumber: 10\n    }\n  }, \"Individual Scores\")\n}, {\n  key: \"comparison_scores\",\n  tab: /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 20,\n      columnNumber: 10\n    }\n  }, \"Comparison Scores\")\n}, {\n  key: \"map\",\n  tab: /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 24,\n      columnNumber: 10\n    }\n  }, \"Map\")\n}];\n\nconst WidgetBox = props => {\n  const dispatch = useDispatch();\n  const {\n    features,\n    featureScore,\n    checkedView,\n    scope,\n    addressInput,\n    isMyWidget = false\n  } = props;\n  const {\n    widgetResult = {\n      address: \"574 Hudson St, New York, NY 10014, USA\"\n    },\n    addUserWidgetResult\n  } = useMappedState(mapStateWidget);\n  const {\n    address\n  } = widgetResult;\n  const [tabKey, setTabKey] = useState(\"individual_scores\");\n  const [modal_visible, setModalVisible] = useState(false);\n  const [name_modal_visible, setName_modal_visible] = useState(false);\n  const [widgetName, setWidgetName] = useState();\n  const [description_text, setDescriptionText] = useState();\n\n  const onTabChange = key => {\n    setTabKey(key);\n  };\n\n  useEffect(() => {\n    if (isMyWidget === true) {\n      return;\n    }\n\n    if (addUserWidgetResult === undefined) return;\n\n    if (addUserWidgetResult.status === \"Successfully\") {\n      _notification[\"success\"]({\n        message: \"Add to myWidget Successfully\",\n        description: \"Add to myWidget Successfully! Please check out in user module.\"\n      });\n\n      return;\n    } else {\n      _notification[\"error\"]({\n        message: \"Failed\",\n        description: \"Something went wrong, please try again latter.\"\n      });\n\n      return;\n    }\n  }, [addUserWidgetResult]);\n\n  const renderChildrenByTabKey = tabKey => {\n    switch (tabKey) {\n      case \"map\":\n        return /*#__PURE__*/React.createElement(\"div\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 80,\n            columnNumber: 11\n          }\n        }, JSON.stringify(featureScore) === \"{}\" ? /*#__PURE__*/React.createElement(NoResult, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 82,\n            columnNumber: 15\n          }\n        }) : /*#__PURE__*/React.createElement(Map, {\n          featuresStatus: features,\n          scope: scope,\n          addressInput: addressInput,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 84,\n            columnNumber: 15\n          }\n        }));\n\n      case \"comparison_scores\":\n        return /*#__PURE__*/React.createElement(\"div\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 11\n          }\n        }, JSON.stringify(featureScore) === \"{}\" ? /*#__PURE__*/React.createElement(NoResult, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 97,\n            columnNumber: 15\n          }\n        }) : /*#__PURE__*/React.createElement(ComparisonScore, {\n          featuresStatus: features,\n          featureScore: featureScore,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 99,\n            columnNumber: 15\n          }\n        }));\n\n      case \"individual_scores\":\n      default:\n        return /*#__PURE__*/React.createElement(\"div\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 110,\n            columnNumber: 11\n          }\n        }, JSON.stringify(featureScore) === \"{}\" ? /*#__PURE__*/React.createElement(NoResult, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 112,\n            columnNumber: 15\n          }\n        }) : /*#__PURE__*/React.createElement(IndividualScore, {\n          featuresStatus: features,\n          featureScore: featureScore,\n          checkedView: checkedView,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 15\n          }\n        }));\n    }\n  };\n\n  const getFeatureList = featureList => {\n    if (featureList === []) {\n      return featureList;\n    }\n\n    featureList.map(item => {\n      delete item.img_faded;\n      delete item.img_new;\n    });\n    return featureList;\n  };\n\n  const handleAddWidget = () => {\n    if (localStorage.getItem(\"isLogin\") === JSON.stringify(false) || localStorage.getItem(\"isLogin\") === null) {\n      setModalVisible(true);\n      return;\n    }\n\n    let featureStatus = getFeatureList(JSON.parse(JSON.stringify(features)).filter(e => e.isChecked));\n\n    if (featureStatus.length === 0) {\n      _notification[\"info\"]({\n        message: \"Please Select features\",\n        description: \"Please select at lease one feature as your customized widget.\"\n      });\n\n      return;\n    }\n\n    setName_modal_visible(true);\n  };\n\n  const handleOk = e => {\n    window.location.href = \"/login\";\n    setModalVisible(false);\n  };\n\n  const handleCancel = e => {\n    setModalVisible(false);\n  };\n\n  const handle_name_Ok = e => {\n    let params = new URLSearchParams();\n    let featureStatus = getFeatureList(JSON.parse(JSON.stringify(features)).filter(e => e.isChecked));\n    let user_id = JSON.parse(localStorage.getItem(\"user_info\")).user_id;\n    params.append(\"selected_features\", \"\" + JSON.stringify(featureStatus));\n    params.append(\"features_score\", \"\" + JSON.stringify(featureScore));\n    params.append(\"checked_view\", \"\" + JSON.stringify(checkedView));\n    params.append(\"scope\", scope);\n    params.append(\"address\", address);\n    params.append(\"user_id\", user_id);\n    params.append(\"widget_name\", widgetName);\n    params.append(\"widget_description\", description_text);\n    dispatch(addUserWidget(params));\n    setName_modal_visible(false);\n  };\n\n  const handle_name_Cancel = e => {\n    setName_modal_visible(false);\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(_Card, {\n    title: !isMyWidget && /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 17\n      }\n    }, \"Customized Widget for\", \" \", /*#__PURE__*/React.createElement(\"span\", {\n      style: {\n        fontWeight: \"bold\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 19\n      }\n    }, address)), /*#__PURE__*/React.createElement(_Button, {\n      style: {\n        float: \"right\",\n        borderRadius: \"10px\"\n      },\n      onClick: handleAddWidget,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 17\n      }\n    }, \"Add to my Widget\")),\n    bordered: true,\n    tabList: operationTabList,\n    activeTabKey: tabKey,\n    onTabChange: onTabChange,\n    style: {\n      minHeight: \"700px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 9\n    }\n  }, renderChildrenByTabKey(tabKey))), /*#__PURE__*/React.createElement(_Modal, {\n    title: \"Login to access the widget\",\n    visible: modal_visible,\n    onOk: handleOk,\n    onCancel: handleCancel,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 9\n    }\n  }, \"Sorry, you need to login to add customized widget!\"), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(_Modal, {\n    title: \"Add to myWidget\",\n    visible: name_modal_visible,\n    onOk: handle_name_Ok,\n    onCancel: handle_name_Cancel,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 9\n    }\n  }, \"Please input a name for the widget:\"), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(_Input, {\n    size: \"large\",\n    value: widgetName,\n    onChange: e => setWidgetName(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 9\n    }\n  }, \"Widget Description:\"), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(TextArea, {\n    rows: 4,\n    value: description_text,\n    onChange: e => setDescriptionText(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 11\n    }\n  }))));\n};\n\nexport default WidgetBox;","map":{"version":3,"sources":["F:/Project/walkspanDeploy/src/pages/widgets/WidgetBox/widgetBox.js"],"names":["React","useEffect","useState","IndividualScore","ComparisonScore","Map","NoResult","useDispatch","useMappedState","addUserWidget","TextArea","mapStateWidget","state","widget","operationTabList","key","tab","WidgetBox","props","dispatch","features","featureScore","checkedView","scope","addressInput","isMyWidget","widgetResult","address","addUserWidgetResult","tabKey","setTabKey","modal_visible","setModalVisible","name_modal_visible","setName_modal_visible","widgetName","setWidgetName","description_text","setDescriptionText","onTabChange","undefined","status","message","description","renderChildrenByTabKey","JSON","stringify","getFeatureList","featureList","map","item","img_faded","img_new","handleAddWidget","localStorage","getItem","featureStatus","parse","filter","e","isChecked","length","handleOk","window","location","href","handleCancel","handle_name_Ok","params","URLSearchParams","user_id","append","handle_name_Cancel","fontWeight","float","borderRadius","minHeight","target","value"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport IndividualScore from \"./IndividualScore/IndividualScore\";\r\nimport ComparisonScore from \"./ComparisonScore/ComparisonScore\";\r\nimport Map from \"./Map/Map\";\r\nimport NoResult from \"./noResult\";\r\n//import styles from \"./widgetBox.module.less\";\r\nimport { Card, Button, Modal, notification, Input } from \"antd\";\r\nimport { useDispatch, useMappedState } from \"redux-react-hook\";\r\nimport { addUserWidget } from \"../../../actions/widget\";\r\nconst { TextArea } = Input;\r\nconst mapStateWidget = (state) => state.widget;\r\n\r\nconst operationTabList = [\r\n  {\r\n    key: \"individual_scores\",\r\n    tab: <span>Individual Scores</span>,\r\n  },\r\n  {\r\n    key: \"comparison_scores\",\r\n    tab: <span>Comparison Scores</span>,\r\n  },\r\n  {\r\n    key: \"map\",\r\n    tab: <span>Map</span>,\r\n  },\r\n];\r\n\r\nconst WidgetBox = (props) => {\r\n  const dispatch = useDispatch();\r\n  const {\r\n    features,\r\n    featureScore,\r\n    checkedView,\r\n    scope,\r\n    addressInput,\r\n    isMyWidget = false,\r\n  } = props;\r\n  const {\r\n    widgetResult = { address: \"574 Hudson St, New York, NY 10014, USA\" },\r\n    addUserWidgetResult,\r\n  } = useMappedState(mapStateWidget);\r\n  const { address } = widgetResult;\r\n  const [tabKey, setTabKey] = useState(\"individual_scores\");\r\n  const [modal_visible, setModalVisible] = useState(false);\r\n  const [name_modal_visible, setName_modal_visible] = useState(false);\r\n  const [widgetName, setWidgetName] = useState();\r\n  const [description_text, setDescriptionText] = useState();\r\n\r\n  const onTabChange = (key) => {\r\n    setTabKey(key);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (isMyWidget === true) {\r\n      return;\r\n    }\r\n\r\n    if (addUserWidgetResult === undefined) return;\r\n\r\n    if (addUserWidgetResult.status === \"Successfully\") {\r\n      notification[\"success\"]({\r\n        message: \"Add to myWidget Successfully\",\r\n        description:\r\n          \"Add to myWidget Successfully! Please check out in user module.\",\r\n      });\r\n      return;\r\n    } else {\r\n      notification[\"error\"]({\r\n        message: \"Failed\",\r\n        description: \"Something went wrong, please try again latter.\",\r\n      });\r\n      return;\r\n    }\r\n  }, [addUserWidgetResult]);\r\n\r\n  const renderChildrenByTabKey = (tabKey) => {\r\n    switch (tabKey) {\r\n      case \"map\":\r\n        return (\r\n          <div>\r\n            {JSON.stringify(featureScore) === \"{}\" ? (\r\n              <NoResult />\r\n            ) : (\r\n              <Map\r\n                featuresStatus={features}\r\n                scope={scope}\r\n                addressInput={addressInput}\r\n              />\r\n            )}\r\n          </div>\r\n        );\r\n\r\n      case \"comparison_scores\":\r\n        return (\r\n          <div>\r\n            {JSON.stringify(featureScore) === \"{}\" ? (\r\n              <NoResult />\r\n            ) : (\r\n              <ComparisonScore\r\n                featuresStatus={features}\r\n                featureScore={featureScore}\r\n              />\r\n            )}\r\n          </div>\r\n        );\r\n\r\n      case \"individual_scores\":\r\n      default:\r\n        return (\r\n          <div>\r\n            {JSON.stringify(featureScore) === \"{}\" ? (\r\n              <NoResult />\r\n            ) : (\r\n              <IndividualScore\r\n                featuresStatus={features}\r\n                featureScore={featureScore}\r\n                checkedView={checkedView}\r\n              />\r\n            )}\r\n          </div>\r\n        );\r\n    }\r\n  };\r\n\r\n  const getFeatureList = (featureList) => {\r\n    if (featureList === []) {\r\n      return featureList;\r\n    }\r\n\r\n    featureList.map((item) => {\r\n      delete item.img_faded;\r\n      delete item.img_new;\r\n    });\r\n    return featureList;\r\n  };\r\n\r\n  const handleAddWidget = () => {\r\n    if (localStorage.getItem(\"isLogin\") === JSON.stringify(false) ||\r\n    localStorage.getItem(\"isLogin\") === null ) {\r\n      setModalVisible(true);\r\n      return;\r\n    }\r\n\r\n    let featureStatus = getFeatureList(\r\n      JSON.parse(JSON.stringify(features)).filter((e) => e.isChecked)\r\n    );\r\n\r\n    if (featureStatus.length === 0) {\r\n      notification[\"info\"]({\r\n        message: \"Please Select features\",\r\n        description:\r\n          \"Please select at lease one feature as your customized widget.\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    setName_modal_visible(true);\r\n  };\r\n\r\n  const handleOk = (e) => {\r\n    window.location.href = \"/login\";\r\n    setModalVisible(false);\r\n  };\r\n\r\n  const handleCancel = (e) => {\r\n    setModalVisible(false);\r\n  };\r\n\r\n  const handle_name_Ok = (e) => {\r\n    let params = new URLSearchParams();\r\n    let featureStatus = getFeatureList(\r\n      JSON.parse(JSON.stringify(features)).filter((e) => e.isChecked)\r\n    );\r\n    let user_id = JSON.parse(localStorage.getItem(\"user_info\")).user_id;\r\n    params.append(\"selected_features\", \"\" + JSON.stringify(featureStatus));\r\n    params.append(\"features_score\", \"\" + JSON.stringify(featureScore));\r\n    params.append(\"checked_view\", \"\" + JSON.stringify(checkedView));\r\n    params.append(\"scope\", scope);\r\n    params.append(\"address\", address);\r\n    params.append(\"user_id\", user_id);\r\n    params.append(\"widget_name\", widgetName);\r\n    params.append(\"widget_description\", description_text);\r\n    dispatch(addUserWidget(params));\r\n    setName_modal_visible(false);\r\n  };\r\n\r\n  const handle_name_Cancel = (e) => {\r\n    setName_modal_visible(false);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <div>\r\n        <Card\r\n          title={\r\n            !isMyWidget && (\r\n              <div>\r\n                <span>\r\n                  Customized Widget for{\" \"}\r\n                  <span style={{ fontWeight: \"bold\" }}>{address}</span>\r\n                </span>\r\n                <Button\r\n                  style={{ float: \"right\", borderRadius: \"10px\" }}\r\n                  onClick={handleAddWidget}\r\n                >\r\n                  Add to my Widget\r\n                </Button>\r\n              </div>\r\n            )\r\n          }\r\n          bordered={true}\r\n          tabList={operationTabList}\r\n          activeTabKey={tabKey}\r\n          onTabChange={onTabChange}\r\n          style={{ minHeight: \"700px\" }}\r\n        >\r\n          {renderChildrenByTabKey(tabKey)}\r\n        </Card>\r\n      </div>\r\n\r\n      <Modal\r\n        title=\"Login to access the widget\"\r\n        visible={modal_visible}\r\n        onOk={handleOk}\r\n        onCancel={handleCancel}\r\n      >\r\n        <p>Sorry, you need to login to add customized widget!</p>\r\n        <p></p>\r\n        <p></p>\r\n      </Modal>\r\n\r\n      <Modal\r\n        title=\"Add to myWidget\"\r\n        visible={name_modal_visible}\r\n        onOk={handle_name_Ok}\r\n        onCancel={handle_name_Cancel}\r\n      >\r\n        <div>Please input a name for the widget:</div>\r\n        <div>\r\n          <Input\r\n            size=\"large\"\r\n            value={widgetName}\r\n            onChange={(e) => setWidgetName(e.target.value)}\r\n          />\r\n        </div>\r\n\r\n        <div>Widget Description:</div>\r\n        <div>\r\n          <TextArea\r\n            rows={4}\r\n            value={description_text}\r\n            onChange={(e) => setDescriptionText(e.target.value)}\r\n          />\r\n        </div>\r\n      </Modal>\r\n      \r\n    </>\r\n  );\r\n};\r\n\r\nexport default WidgetBox;\r\n"]},"metadata":{},"sourceType":"module"}